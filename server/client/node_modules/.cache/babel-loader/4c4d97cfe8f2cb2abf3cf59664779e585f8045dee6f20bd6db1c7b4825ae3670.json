{"ast":null,"code":"import React,{useEffect}from'react';import{useNavigate,useLocation}from'react-router-dom';import{useAuth}from'../../context/AuthContext';import styled from'styled-components';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AuthCallback=()=>{const navigate=useNavigate();const location=useLocation();const{setUser,setIsAuthenticated}=useAuth();useEffect(()=>{const params=new URLSearchParams(location.search);const token=params.get('token');const error=params.get('error');if(error){navigate('/login');return;}if(token){// Store the token\nlocalStorage.setItem('token',token);// Decode the JWT to get user info\ntry{const base64Url=token.split('.')[1];const base64=base64Url.replace(/-/g,'+').replace(/_/g,'/');const jsonPayload=decodeURIComponent(atob(base64).split('').map(c=>{return'%'+('00'+c.charCodeAt(0).toString(16)).slice(-2);}).join(''));const user=JSON.parse(jsonPayload);localStorage.setItem('user',JSON.stringify(user));setUser(user);setIsAuthenticated(true);navigate('/dashboard');}catch(error){console.error('Error processing token:',error);navigate('/login');}}else{navigate('/login');}},[navigate,location,setUser,setIsAuthenticated]);return/*#__PURE__*/_jsx(CallbackStyled,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Completing authentication...\"})]})});};const CallbackStyled=styled.div`\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(252, 246, 249, 0.78);\n\n  .loading-container {\n    text-align: center;\n\n    .spinner {\n      width: 50px;\n      height: 50px;\n      border: 5px solid #f3f3f3;\n      border-top: 5px solid #2ABF4A;\n      border-radius: 50%;\n      animation: spin 1s linear infinite;\n      margin: 0 auto 1rem;\n    }\n\n    p {\n      color: #666;\n      font-size: 1.1rem;\n    }\n  }\n\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n`;export default AuthCallback;","map":{"version":3,"names":["React","useEffect","useNavigate","useLocation","useAuth","styled","jsx","_jsx","jsxs","_jsxs","AuthCallback","navigate","location","setUser","setIsAuthenticated","params","URLSearchParams","search","token","get","error","localStorage","setItem","base64Url","split","base64","replace","jsonPayload","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","user","JSON","parse","stringify","console","CallbackStyled","children","className","div"],"sources":["C:/Users/jalle/VSC/miniproject/server/client/src/Components/Auth/AuthCallback.js"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport styled from 'styled-components';\r\n\r\nconst AuthCallback = () => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { setUser, setIsAuthenticated } = useAuth();\r\n\r\n  useEffect(() => {\r\n    const params = new URLSearchParams(location.search);\r\n    const token = params.get('token');\r\n    const error = params.get('error');\r\n\r\n    if (error) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n\r\n    if (token) {\r\n      // Store the token\r\n      localStorage.setItem('token', token);\r\n      \r\n      // Decode the JWT to get user info\r\n      try {\r\n        const base64Url = token.split('.')[1];\r\n        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n        const jsonPayload = decodeURIComponent(atob(base64).split('').map(c => {\r\n          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\r\n        }).join(''));\r\n\r\n        const user = JSON.parse(jsonPayload);\r\n        localStorage.setItem('user', JSON.stringify(user));\r\n        setUser(user);\r\n        setIsAuthenticated(true);\r\n        navigate('/dashboard');\r\n      } catch (error) {\r\n        console.error('Error processing token:', error);\r\n        navigate('/login');\r\n      }\r\n    } else {\r\n      navigate('/login');\r\n    }\r\n  }, [navigate, location, setUser, setIsAuthenticated]);\r\n\r\n  return (\r\n    <CallbackStyled>\r\n      <div className=\"loading-container\">\r\n        <div className=\"spinner\"></div>\r\n        <p>Completing authentication...</p>\r\n      </div>\r\n    </CallbackStyled>\r\n  );\r\n};\r\n\r\nconst CallbackStyled = styled.div`\r\n  height: 100vh;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background: rgba(252, 246, 249, 0.78);\r\n\r\n  .loading-container {\r\n    text-align: center;\r\n\r\n    .spinner {\r\n      width: 50px;\r\n      height: 50px;\r\n      border: 5px solid #f3f3f3;\r\n      border-top: 5px solid #2ABF4A;\r\n      border-radius: 50%;\r\n      animation: spin 1s linear infinite;\r\n      margin: 0 auto 1rem;\r\n    }\r\n\r\n    p {\r\n      color: #666;\r\n      font-size: 1.1rem;\r\n    }\r\n  }\r\n\r\n  @keyframes spin {\r\n    0% { transform: rotate(0deg); }\r\n    100% { transform: rotate(360deg); }\r\n  }\r\n`;\r\n\r\nexport default AuthCallback; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}